# Ø®Ø·Ø© ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª - URL Shortener

> ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙØ¬ÙˆØ© Ø¨ÙŠÙ† Ù…Ù…ÙŠØ²Ø§ØªÙ†Ø§ ÙˆÙ…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ† + Ø®Ø·Ø© Ø§Ù„ØªÙ†ÙÙŠØ°

---

## Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ

### Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© Ø¨Ø§Ù„ÙØ¹Ù„ âœ…

| Ø§Ù„Ù…ÙŠØ²Ø© | Ø§Ù„Ø­Ø§Ù„Ø© | Ù…Ù„Ø§Ø­Ø¸Ø§Øª |
|--------|--------|---------|
| Ø§Ø®ØªØµØ§Ø± Ø§Ù„Ø±ÙˆØ§Ø¨Ø· | âœ… ÙƒØ§Ù…Ù„ | nanoid 7 Ø£Ø­Ø±Ù |
| Custom Alias | âœ… ÙƒØ§Ù…Ù„ | 3-50 Ø­Ø±Ù |
| Bulk Shortening | âœ… ÙƒØ§Ù…Ù„ | Ø­ØªÙ‰ 100 Ø±Ø§Ø¨Ø· |
| QR Codes | âœ… ÙƒØ§Ù…Ù„ | Ø£Ù„ÙˆØ§Ù† + Ø£Ø­Ø¬Ø§Ù… Ù…Ø®ØµØµØ© |
| Password Protection | âœ… ÙƒØ§Ù…Ù„ | bcrypt hashing |
| Link Expiration | âœ… ÙƒØ§Ù…Ù„ | ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ |
| Analytics | âœ… ÙƒØ§Ù…Ù„ | clicks, devices, browsers, OS, countries, referrers |
| Export (CSV/JSON) | âœ… ÙƒØ§Ù…Ù„ | ØªØµØ¯ÙŠØ± Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª |
| Link Preview | âœ… ÙƒØ§Ù…Ù„ | Ù…Ø¹Ø§ÙŠÙ†Ø© Ù‚Ø¨Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„ |
| Arabic/RTL | âœ… ÙƒØ§Ù…Ù„ | Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ |
| Dark/Light Mode | âœ… ÙƒØ§Ù…Ù„ | toggle + persistence |
| REST API | âœ… ÙƒØ§Ù…Ù„ | 8 endpoints Ù…ÙˆØ«Ù‚Ø© |
| Responsive Design | âœ… ÙƒØ§Ù…Ù„ | mobile-first |

---

## Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù†Ø§Ù‚ØµØ© (Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨Ø§Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ†)

### Ø£ÙˆÙ„ÙˆÙŠØ© Ù‚ØµÙˆÙ‰ (Critical Ù„Ù„Ø±Ø¨Ø­) ğŸ”´

| Ø§Ù„Ù…ÙŠØ²Ø© | Ø§Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ† | Ø§Ù„Ø£Ù‡Ù…ÙŠØ© | Ø§Ù„ØªØ¹Ù‚ÙŠØ¯ |
|--------|-----------|---------|---------|
| User Authentication | Ø§Ù„ÙƒÙ„ | ğŸ”´ Ø­Ø±Ø¬Ø© | Ù…ØªÙˆØ³Ø· |
| Subscription System | Ø§Ù„ÙƒÙ„ | ğŸ”´ Ø­Ø±Ø¬Ø© | Ø¹Ø§Ù„ÙŠ |
| Usage Limits/Quotas | Ø§Ù„ÙƒÙ„ | ğŸ”´ Ø­Ø±Ø¬Ø© | Ù…ØªÙˆØ³Ø· |
| API Rate Limiting | Ø§Ù„ÙƒÙ„ | ğŸ”´ Ø­Ø±Ø¬Ø© | Ù…Ù†Ø®ÙØ¶ |

### Ø£ÙˆÙ„ÙˆÙŠØ© Ø¹Ø§Ù„ÙŠØ© (ØªÙ†Ø§ÙØ³ÙŠØ©) ğŸŸ 

| Ø§Ù„Ù…ÙŠØ²Ø© | Ø§Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ† | Ø§Ù„Ø£Ù‡Ù…ÙŠØ© | Ø§Ù„ØªØ¹Ù‚ÙŠØ¯ |
|--------|-----------|---------|---------|
| Custom Domains | Bitly, Rebrandly, Dub.co, Short.io | ğŸŸ  Ø¹Ø§Ù„ÙŠØ© | Ø¹Ø§Ù„ÙŠ |
| UTM Builder | Bitly, Rebrandly | ğŸŸ  Ø¹Ø§Ù„ÙŠØ© | Ù…Ù†Ø®ÙØ¶ |
| Tags/Folders | Dub.co, Short.io, Rebrandly | ğŸŸ  Ø¹Ø§Ù„ÙŠØ© | Ù…Ù†Ø®ÙØ¶ |
| Link Edit (change destination) | Ø§Ù„ÙƒÙ„ | ğŸŸ  Ø¹Ø§Ù„ÙŠØ© | Ù…Ù†Ø®ÙØ¶ |

### Ø£ÙˆÙ„ÙˆÙŠØ© Ù…ØªÙˆØ³Ø·Ø© (Ù‚ÙŠÙ…Ø© Ù…Ø¶Ø§ÙØ©) ğŸŸ¡

| Ø§Ù„Ù…ÙŠØ²Ø© | Ø§Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ† | Ø§Ù„Ø£Ù‡Ù…ÙŠØ© | Ø§Ù„ØªØ¹Ù‚ÙŠØ¯ |
|--------|-----------|---------|---------|
| Device Targeting | Dub.co, Short.io, T.ly | ğŸŸ¡ Ù…ØªÙˆØ³Ø·Ø© | Ù…ØªÙˆØ³Ø· |
| Geo Targeting | Dub.co, Short.io, Bitly Premium | ğŸŸ¡ Ù…ØªÙˆØ³Ø·Ø© | Ù…ØªÙˆØ³Ø· |
| Team/Workspace | Rebrandly, Short.io, Dub.co | ğŸŸ¡ Ù…ØªÙˆØ³Ø·Ø© | Ø¹Ø§Ù„ÙŠ |
| Webhooks | Dub.co, Short.io | ğŸŸ¡ Ù…ØªÙˆØ³Ø·Ø© | Ù…ØªÙˆØ³Ø· |

### Ø£ÙˆÙ„ÙˆÙŠØ© Ù…Ù†Ø®ÙØ¶Ø© (Nice to Have) ğŸŸ¢

| Ø§Ù„Ù…ÙŠØ²Ø© | Ø§Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ† | Ø§Ù„Ø£Ù‡Ù…ÙŠØ© | Ø§Ù„ØªØ¹Ù‚ÙŠØ¯ |
|--------|-----------|---------|---------|
| A/B Testing | Dub.co, Cuttly | ğŸŸ¢ Ù…Ù†Ø®ÙØ¶Ø© | Ø¹Ø§Ù„ÙŠ |
| Link Cloaking | Short.io | ğŸŸ¢ Ù…Ù†Ø®ÙØ¶Ø© | Ù…Ù†Ø®ÙØ¶ |
| Deep Links | Bitly, Dub.co | ğŸŸ¢ Ù…Ù†Ø®ÙØ¶Ø© | Ø¹Ø§Ù„ÙŠ |
| Retargeting Pixels | T.ly, Rebrandly | ğŸŸ¢ Ù…Ù†Ø®ÙØ¶Ø© | Ù…ØªÙˆØ³Ø· |
| Bio Link Pages | Cuttly, Bitly | ğŸŸ¢ Ù…Ù†Ø®ÙØ¶Ø© | Ø¹Ø§Ù„ÙŠ |
| Zapier Integration | Ø§Ù„ÙƒÙ„ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹ | ğŸŸ¢ Ù…Ù†Ø®ÙØ¶Ø© | Ù…ØªÙˆØ³Ø· |
| Browser Extension | T.ly, Bitly | ğŸŸ¢ Ù…Ù†Ø®ÙØ¶Ø© | Ù…ØªÙˆØ³Ø· |
| Mobile App | Bitly | ğŸŸ¢ Ù…Ù†Ø®ÙØ¶Ø© | Ø¹Ø§Ù„ÙŠ Ø¬Ø¯Ø§Ù‹ |

---

## Ø®Ø·Ø© Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©

---

## Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª Ù„Ù„Ø±Ø¨Ø­ (Ø£Ø³Ø¨ÙˆØ¹ 1-2)

### 1.1 User Authentication (NextAuth.js)

**Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:**
```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/auth/[...nextauth]/route.ts
â”‚   â”œâ”€â”€ [locale]/login/page.tsx
â”‚   â”œâ”€â”€ [locale]/register/page.tsx
â”‚   â””â”€â”€ [locale]/profile/page.tsx
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ auth/
â”‚       â”œâ”€â”€ config.ts
â”‚       â””â”€â”€ providers.ts
â””â”€â”€ components/
    â””â”€â”€ auth/
        â”œâ”€â”€ LoginForm.tsx
        â”œâ”€â”€ RegisterForm.tsx
        â””â”€â”€ UserMenu.tsx
```

**Database Schema Ø¥Ø¶Ø§ÙØ§Øª:**
```prisma
model User {
  id            String    @id @default(cuid())
  email         String    @unique
  name          String?
  password      String?   // Ù„Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¹Ø§Ø¯ÙŠ
  image         String?
  emailVerified DateTime?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  // Relations
  links         Link[]
  subscription  Subscription?
  apiKeys       ApiKey[]
}

model Account {
  // NextAuth.js OAuth accounts
}

model Session {
  // NextAuth.js sessions
}
```

**Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:**
- [ ] ØªØ³Ø¬ÙŠÙ„ Ø¨Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„/ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±
- [ ] ØªØ³Ø¬ÙŠÙ„ Ø¨Ù€ Google OAuth
- [ ] ØªØ³Ø¬ÙŠÙ„ Ø¨Ù€ GitHub OAuth
- [ ] Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±
- [ ] ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„
- [ ] ØµÙØ­Ø© Profile

---

### 1.2 Subscription System (Stripe)

**Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:**
```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ stripe/
â”‚   â”‚   â”‚   â”œâ”€â”€ checkout/route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ webhook/route.ts
â”‚   â”‚   â”‚   â””â”€â”€ portal/route.ts
â”‚   â””â”€â”€ [locale]/pricing/page.tsx
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ stripe/
â”‚       â”œâ”€â”€ client.ts
â”‚       â”œâ”€â”€ plans.ts
â”‚       â””â”€â”€ subscription.ts
â””â”€â”€ components/
    â””â”€â”€ pricing/
        â”œâ”€â”€ PricingTable.tsx
        â”œâ”€â”€ PlanCard.tsx
        â””â”€â”€ UpgradeButton.tsx
```

**Database Schema:**
```prisma
model Subscription {
  id                 String   @id @default(cuid())
  userId             String   @unique
  user               User     @relation(fields: [userId], references: [id])

  stripeCustomerId   String?  @unique
  stripeSubscriptionId String? @unique
  stripePriceId      String?

  plan               Plan     @default(FREE)
  status             SubscriptionStatus @default(ACTIVE)

  currentPeriodStart DateTime?
  currentPeriodEnd   DateTime?
  cancelAtPeriodEnd  Boolean  @default(false)

  // Usage tracking
  linksUsed          Int      @default(0)
  linksLimit         Int      @default(100)

  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt
}

enum Plan {
  FREE
  STARTER
  PRO
  BUSINESS
  ENTERPRISE
}

enum SubscriptionStatus {
  ACTIVE
  CANCELED
  PAST_DUE
  TRIALING
}
```

**Ø§Ù„Ø®Ø·Ø·:**
```typescript
export const PLANS = {
  FREE: {
    name: 'Free',
    price: 0,
    limits: {
      linksPerMonth: 100,
      clicksTracked: 10000,
      customDomains: 0,
      teamMembers: 1,
      apiRequests: 1000,
      analyticsRetention: 30, // days
    },
    features: ['Basic Analytics', 'QR Codes', 'Custom Alias'],
  },
  STARTER: {
    name: 'Starter',
    price: 5,
    stripePriceId: 'price_xxx',
    limits: {
      linksPerMonth: 1000,
      clicksTracked: 50000,
      customDomains: 1,
      teamMembers: 1,
      apiRequests: 10000,
      analyticsRetention: 90,
    },
    features: ['Everything in Free', 'Advanced Analytics', 'API Access', 'No Ads'],
  },
  // ... PRO, BUSINESS, ENTERPRISE
};
```

---

### 1.3 Usage Limits & Quotas

**Ø§Ù„Ù…Ù„ÙØ§Øª:**
```
src/lib/
â”œâ”€â”€ limits/
â”‚   â”œâ”€â”€ checker.ts      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¯ÙˆØ¯
â”‚   â”œâ”€â”€ counter.ts      // Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
â”‚   â””â”€â”€ middleware.ts   // Middleware Ù„Ù„ØªØ­Ù‚Ù‚
```

**Implementation:**
```typescript
// src/lib/limits/checker.ts
export async function checkLinkLimit(userId: string): Promise<{
  allowed: boolean;
  used: number;
  limit: number;
  remaining: number;
}> {
  const subscription = await getSubscription(userId);
  const linksThisMonth = await countLinksThisMonth(userId);

  return {
    allowed: linksThisMonth < subscription.linksLimit,
    used: linksThisMonth,
    limit: subscription.linksLimit,
    remaining: subscription.linksLimit - linksThisMonth,
  };
}
```

---

### 1.4 API Rate Limiting

**Ø§Ù„Ù…Ù„ÙØ§Øª:**
```
src/lib/
â”œâ”€â”€ rate-limit/
â”‚   â”œâ”€â”€ limiter.ts
â”‚   â””â”€â”€ store.ts    // Redis or in-memory
```

**Implementation:**
```typescript
// Simple in-memory rate limiter
const rateLimit = new Map<string, { count: number; resetAt: number }>();

export async function checkRateLimit(
  identifier: string, // API key or IP
  limit: number,
  windowMs: number
): Promise<{ allowed: boolean; remaining: number; resetAt: number }> {
  const now = Date.now();
  const record = rateLimit.get(identifier);

  if (!record || record.resetAt < now) {
    rateLimit.set(identifier, { count: 1, resetAt: now + windowMs });
    return { allowed: true, remaining: limit - 1, resetAt: now + windowMs };
  }

  if (record.count >= limit) {
    return { allowed: false, remaining: 0, resetAt: record.resetAt };
  }

  record.count++;
  return { allowed: true, remaining: limit - record.count, resetAt: record.resetAt };
}
```

---

## Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2: Ù…Ù…ÙŠØ²Ø§Øª ØªÙ†Ø§ÙØ³ÙŠØ© (Ø£Ø³Ø¨ÙˆØ¹ 3-4)

### 2.1 UTM Builder

**UI Component:**
```
src/components/url/
â””â”€â”€ UtmBuilder.tsx
```

**Features:**
- [ ] UTM Source
- [ ] UTM Medium
- [ ] UTM Campaign
- [ ] UTM Term
- [ ] UTM Content
- [ ] Preview URL Ù…Ø¹ UTM
- [ ] Ø­ÙØ¸ templates

**Implementation Ø¨Ø³ÙŠØ· Ø¬Ø¯Ø§Ù‹:**
```typescript
interface UtmParams {
  source?: string;
  medium?: string;
  campaign?: string;
  term?: string;
  content?: string;
}

export function buildUtmUrl(baseUrl: string, utm: UtmParams): string {
  const url = new URL(baseUrl);
  if (utm.source) url.searchParams.set('utm_source', utm.source);
  if (utm.medium) url.searchParams.set('utm_medium', utm.medium);
  if (utm.campaign) url.searchParams.set('utm_campaign', utm.campaign);
  if (utm.term) url.searchParams.set('utm_term', utm.term);
  if (utm.content) url.searchParams.set('utm_content', utm.content);
  return url.toString();
}
```

---

### 2.2 Tags & Folders

**Database Schema Ø¥Ø¶Ø§ÙØ©:**
```prisma
model Folder {
  id        String   @id @default(cuid())
  name      String
  color     String?  // hex color
  userId    String
  user      User     @relation(fields: [userId], references: [id])
  links     Link[]
  createdAt DateTime @default(now())

  @@unique([userId, name])
}

// Update Link model
model Link {
  // ... existing fields
  folderId  String?
  folder    Folder?  @relation(fields: [folderId], references: [id])
  tags      Tag[]
}
```

**UI:**
- [ ] Folder sidebar ÙÙŠ Dashboard
- [ ] Drag & drop Ù„Ù„Ø±ÙˆØ§Ø¨Ø·
- [ ] Tags badges Ø¹Ù„Ù‰ Link Cards
- [ ] Filter by folder/tag

---

### 2.3 Link Editing (Change Destination)

**Ø­Ø§Ù„ÙŠØ§Ù‹:** ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ù† API Ù„ÙƒÙ† Ù…ÙÙŠØ´ UI

**Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:**
```
src/components/url/
â””â”€â”€ LinkEditDialog.tsx
```

**Features:**
- [ ] Edit original URL
- [ ] Edit custom alias
- [ ] Edit title/description
- [ ] Edit expiration
- [ ] Edit password
- [ ] Edit tags/folder

---

### 2.4 Custom Domains

**Database Schema:**
```prisma
model CustomDomain {
  id          String   @id @default(cuid())
  domain      String   @unique
  userId      String
  user        User     @relation(fields: [userId], references: [id])

  verified    Boolean  @default(false)
  verifyToken String?

  sslStatus   SslStatus @default(PENDING)

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

enum SslStatus {
  PENDING
  ACTIVE
  FAILED
}
```

**Ø§Ù„Ù…Ù„ÙØ§Øª:**
```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/domains/
â”‚   â”‚   â”œâ”€â”€ route.ts           // CRUD
â”‚   â”‚   â”œâ”€â”€ [id]/verify/route.ts
â”‚   â”‚   â””â”€â”€ [id]/ssl/route.ts
â”‚   â””â”€â”€ [locale]/domains/page.tsx
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ domains/
â”‚       â”œâ”€â”€ verifier.ts
â”‚       â””â”€â”€ ssl.ts
```

**Verification Process:**
1. User ÙŠØ¶ÙŠÙ domain
2. Ù†ÙˆÙ„Ø¯ verification token
3. User ÙŠØ¶ÙŠÙ DNS TXT record
4. Ù†ØªØ­Ù‚Ù‚ Ù…Ù† DNS
5. Ù†ÙØ¹Ù„ SSL (Let's Encrypt Ø£Ùˆ Cloudflare)

**Ù…Ù„Ø§Ø­Ø¸Ø©:** Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØªØ­ØªØ§Ø¬ infrastructure (Vercel/Cloudflare) Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ wildcard domains.

---

## Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3: Ù…Ù…ÙŠØ²Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© (Ø£Ø³Ø¨ÙˆØ¹ 5-6)

### 3.1 Device Targeting

**Database Schema:**
```prisma
model LinkTarget {
  id        String   @id @default(cuid())
  linkId    String
  link      Link     @relation(fields: [linkId], references: [id])

  type      TargetType
  value     String    // e.g., "ios", "android", "US", "EG"
  targetUrl String

  priority  Int       @default(0)

  @@index([linkId])
}

enum TargetType {
  DEVICE      // mobile, desktop, tablet
  OS          // ios, android, windows, macos
  BROWSER     // chrome, safari, firefox
  COUNTRY     // country code
  LANGUAGE    // language code
}
```

**Redirect Logic:**
```typescript
async function getTargetUrl(link: Link, request: Request): Promise<string> {
  const targets = await getTargets(link.id);

  if (targets.length === 0) return link.originalUrl;

  const userAgent = request.headers.get('user-agent');
  const device = parseDevice(userAgent);
  const country = getCountryFromIP(request);

  // Sort by priority
  const sortedTargets = targets.sort((a, b) => b.priority - a.priority);

  for (const target of sortedTargets) {
    if (matchesTarget(target, { device, country })) {
      return target.targetUrl;
    }
  }

  return link.originalUrl;
}
```

---

### 3.2 Team/Workspace Features

**Database Schema:**
```prisma
model Workspace {
  id        String   @id @default(cuid())
  name      String
  slug      String   @unique
  ownerId   String
  owner     User     @relation("WorkspaceOwner", fields: [ownerId], references: [id])

  members   WorkspaceMember[]
  links     Link[]

  createdAt DateTime @default(now())
}

model WorkspaceMember {
  id          String    @id @default(cuid())
  workspaceId String
  workspace   Workspace @relation(fields: [workspaceId], references: [id])
  userId      String
  user        User      @relation(fields: [userId], references: [id])

  role        WorkspaceRole @default(MEMBER)

  joinedAt    DateTime @default(now())

  @@unique([workspaceId, userId])
}

enum WorkspaceRole {
  OWNER
  ADMIN
  MEMBER
  VIEWER
}
```

---

### 3.3 Webhooks

**Database Schema:**
```prisma
model Webhook {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id])

  url         String
  secret      String   // for signature verification
  events      String[] // ["link.created", "link.clicked", etc.]

  isActive    Boolean  @default(true)

  createdAt   DateTime @default(now())
}

model WebhookLog {
  id          String   @id @default(cuid())
  webhookId   String
  webhook     Webhook  @relation(fields: [webhookId], references: [id])

  event       String
  payload     Json
  statusCode  Int?
  response    String?

  createdAt   DateTime @default(now())
}
```

**Events:**
- `link.created`
- `link.updated`
- `link.deleted`
- `link.clicked`
- `link.expired`

---

## Ø§Ù„Ù…Ø±Ø­Ù„Ø© 4: Ù…Ù…ÙŠØ²Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© (Ø£Ø³Ø¨ÙˆØ¹ 7+)

### 4.1 A/B Testing

```prisma
model ABTest {
  id        String   @id @default(cuid())
  linkId    String
  link      Link     @relation(fields: [linkId], references: [id])

  variants  ABVariant[]

  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
}

model ABVariant {
  id        String   @id @default(cuid())
  testId    String
  test      ABTest   @relation(fields: [testId], references: [id])

  name      String   // "A", "B", "C"
  url       String
  weight    Int      @default(50) // percentage

  clicks    Int      @default(0)
  conversions Int    @default(0)
}
```

### 4.2 Link Cloaking

```typescript
// ÙÙŠ Ø§Ù„Ù€ redirectØŒ Ø¨Ø¯Ù„ redirect Ø¹Ø§Ø¯ÙŠ:
// Option 1: iframe
// Option 2: server-side proxy (ÙŠØ­ØªØ§Ø¬ bandwidth)
```

### 4.3 Retargeting Pixels

```prisma
model RetargetingPixel {
  id        String   @id @default(cuid())
  userId    String
  user      User     @relation(fields: [userId], references: [id])

  name      String
  type      PixelType // FACEBOOK, GOOGLE, TWITTER, LINKEDIN, CUSTOM
  pixelId   String

  createdAt DateTime @default(now())
}

// ÙÙŠ Ø§Ù„Ù€ preview/redirect pageØŒ inject the pixel
```

### 4.4 Bio Link Pages

```prisma
model BioPage {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id])

  slug        String   @unique
  title       String
  bio         String?
  avatar      String?
  theme       String   @default("default")

  links       BioLink[]

  createdAt   DateTime @default(now())
}

model BioLink {
  id        String   @id @default(cuid())
  pageId    String
  page      BioPage  @relation(fields: [pageId], references: [id])

  title     String
  url       String
  icon      String?
  order     Int      @default(0)

  clicks    Int      @default(0)
}
```

---

## Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ù‚ØªØ±Ø­

| Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ | Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª | Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© |
|---------|----------|----------|
| 1 | User Authentication | ğŸ”´ |
| 2 | Subscription System + Stripe | ğŸ”´ |
| 3 | Usage Limits + Rate Limiting | ğŸ”´ |
| 3 | UTM Builder | ğŸŸ  |
| 4 | Tags & Folders | ğŸŸ  |
| 4 | Link Edit Dialog | ğŸŸ  |
| 5 | Custom Domains | ğŸŸ  |
| 6 | Device/Geo Targeting | ğŸŸ¡ |
| 7 | Team/Workspace | ğŸŸ¡ |
| 8 | Webhooks | ğŸŸ¡ |
| 9+ | A/B Testing, Bio Pages, etc. | ğŸŸ¢ |

---

## Ù…Ù„Ø®Øµ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª

### ÙŠØ¬Ø¨ ØªÙ†ÙÙŠØ°Ù‡Ø§ Ø£ÙˆÙ„Ø§Ù‹ (Ù„Ù„Ø±Ø¨Ø­):
1. âœ… **User Authentication** - Ø¨Ø¯ÙˆÙ†Ù‡Ø§ Ù…ÙÙŠØ´ Ø§Ø´ØªØ±Ø§ÙƒØ§Øª
2. âœ… **Subscription System** - Ù„ØªØ­ØµÙŠÙ„ Ø§Ù„ÙÙ„ÙˆØ³
3. âœ… **Usage Limits** - Ù„Ù„ØªÙØ±ÙŠÙ‚ Ø¨ÙŠÙ† Ø§Ù„Ø®Ø·Ø·
4. âœ… **API Rate Limiting** - Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø®Ø¯Ù…Ø©

### ÙŠØ¬Ø¨ ØªÙ†ÙÙŠØ°Ù‡Ø§ Ø«Ø§Ù†ÙŠØ§Ù‹ (Ù„Ù„ØªÙ†Ø§ÙØ³):
5. âœ… **UTM Builder** - Ø³Ù‡Ù„ ÙˆÙ‚ÙŠÙ…Ø© Ø¹Ø§Ù„ÙŠØ©
6. âœ… **Tags & Folders** - ØªÙ†Ø¸ÙŠÙ… Ø£ÙØ¶Ù„
7. âœ… **Link Edit Dialog** - UX Ø£Ø³Ø§Ø³ÙŠ
8. âœ… **Custom Domains** - Ù…ÙŠØ²Ø© Ù…Ø¯ÙÙˆØ¹Ø© Ù…Ù‡Ù…Ø©

### ÙŠÙ…ÙƒÙ† ØªØ£Ø¬ÙŠÙ„Ù‡Ø§:
- Device/Geo Targeting
- Team Features
- Webhooks
- A/B Testing
- Bio Pages

---

## Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©

**Ø§Ø¨Ø¯Ø£ Ø¨Ù€:**
1. User Authentication (NextAuth.js)
2. Ø«Ù… Subscription System (Stripe)

Ù‡Ù„ Ù†Ø¨Ø¯Ø£ Ø¨Ø§Ù„ØªÙ†ÙÙŠØ°ØŸ
